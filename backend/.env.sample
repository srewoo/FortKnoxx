# ============================================
# FortKnoxx Environment Configuration
# ============================================
# Copy this file to .env and configure your settings
# Command: cp .env.sample .env

# ============================================
# DATABASE CONFIGURATION
# ============================================
# MongoDB connection URL
MONGO_URL=mongodb://localhost:27017

# Database name
DB_NAME=fortknox_db

# CORS origins (comma-separated, or * for all)
CORS_ORIGINS=*

# ============================================
# PHASE 1: AUTHENTICATION & SECURITY
# ============================================
# IMPORTANT: Generate secure keys for production!
# These are REQUIRED for the application to function properly

# JWT Secret Key (REQUIRED)
# Generate with: openssl rand -hex 32
JWT_SECRET_KEY=your-jwt-secret-key-CHANGE-THIS-IN-PRODUCTION-use-openssl-rand-hex-32

# Master Encryption Key (REQUIRED)
# Generate with: python -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
ENCRYPTION_MASTER_KEY=your-encryption-key-CHANGE-THIS-use-fernet-generate-key

# Optional: Redis for production job queue (falls back to in-memory if not set)
# Install: brew services start redis (macOS) or sudo systemctl start redis (Linux)
REDIS_URL=redis://localhost:6379

# ============================================
# LLM API KEYS (OPTIONAL - BYOK Model)
# ============================================
# These keys enable AI-powered vulnerability fix recommendations
# and LLM security testing features
# All keys are OPTIONAL - features work without them
#
# NOTE: You can also configure these keys through the Settings UI
# at http://localhost:3000/settings (recommended method)
# Keys configured in the UI are encrypted and stored in MongoDB

# OpenAI API Key
# Get your key from: https://platform.openai.com/api-keys
# Free tier: $5 credit for new accounts
# OPENAI_API_KEY=sk-...

# Anthropic API Key (Claude)
# Get your key from: https://console.anthropic.com/
# Free tier: Rate-limited access
# ANTHROPIC_API_KEY=sk-ant-...

# Google Gemini API Key
# Get your key from: https://makersuite.google.com/app/apikey
# Free tier: 60 requests per minute
# GEMINI_API_KEY=AIza...

# ============================================
# SCANNER CONFIGURATION (OPTIONAL)
# ============================================
# Most scanners work out of the box without configuration
# Add configs here only if needed for specific features

# GitHub Token (Optional - improves rate limits)
# Generate at: https://github.com/settings/tokens
# Scopes needed: public_repo (for public repos) or repo (for private repos)
# GITHUB_TOKEN=ghp_...

# Snyk Token (Optional - for Snyk scanner authentication)
# Get your token from: https://snyk.io/account
# Free tier: 200 tests per month
# SNYK_TOKEN=...

# ============================================
# ADVANCED CONFIGURATION (OPTIONAL)
# ============================================

# Log Level (DEBUG, INFO, WARNING, ERROR, CRITICAL)
# LOG_LEVEL=INFO

# Maximum concurrent scans
# MAX_CONCURRENT_SCANS=3

# Scan timeout in seconds
# SCAN_TIMEOUT=3600

# Job queue worker count (if using Redis)
# JOB_WORKERS=4

# ============================================
# QUICKSTART GUIDE
# ============================================
#
# 1. COPY THIS FILE:
#    cp .env.sample .env
#
# 2. GENERATE SECURITY KEYS:
#    # JWT Secret
#    openssl rand -hex 32
#
#    # Encryption Key
#    python -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
#
# 3. UPDATE .env FILE:
#    - Replace JWT_SECRET_KEY with generated value
#    - Replace ENCRYPTION_MASTER_KEY with generated value
#
# 4. (OPTIONAL) ADD LLM API KEYS:
#    - Either uncomment and add keys here
#    - OR configure later through the Settings UI (recommended)
#
# 5. START SERVICES:
#    # Start MongoDB
#    brew services start mongodb-community  # macOS
#    # OR
#    sudo systemctl start mongod  # Linux
#
#    # (Optional) Start Redis
#    brew services start redis  # macOS
#    # OR
#    sudo systemctl start redis  # Linux
#
# 6. START APPLICATION:
#    # Backend
#    cd backend
#    source venv/bin/activate
#    uvicorn server:app --reload --port 8000
#
#    # Frontend (in new terminal)
#    cd frontend
#    yarn start
#
# 7. OPEN APPLICATION:
#    http://localhost:3000
#
# ============================================
# SECURITY NOTES
# ============================================
#
# - NEVER commit .env file to version control
# - .env is in .gitignore by default
# - Rotate keys regularly in production
# - Use environment-specific keys (dev/staging/prod)
# - Store production keys in secure vault (AWS Secrets Manager, etc.)
# - LLM API keys can be managed through Settings UI for better security
# - All sensitive data is encrypted with ENCRYPTION_MASTER_KEY
#
# ============================================
# FEATURE FLAGS (OPTIONAL)
# ============================================
#
# Enable/disable specific features
# ENABLE_AI_FEATURES=true
# ENABLE_BUSINESS_LOGIC_SCANNER=true
# ENABLE_AUTH_SCANNER=true
# ENABLE_LLM_SECURITY_SCANNER=true
# ENABLE_ZERO_DAY_DETECTOR=true
#
# ============================================
# LARGE REPOSITORY HANDLING (OPTIONAL)
# ============================================
#
# These settings optimize scanning for large repositories
# Default values work well for most repos (<1000 files)
#
# File Limits
# SCAN_MAX_FILES_AI=500        # Max files for AI analysis
# SCAN_MAX_FILE_SIZE_KB=500    # Skip files larger than this (likely minified)
# SCAN_MAX_REPO_SIZE_MB=500    # Warn if repo exceeds this size
#
# Timeout Limits (in seconds)
# SCAN_SCANNER_TIMEOUT=300     # Per-scanner timeout (5 minutes)
# SCAN_AI_SCANNER_TIMEOUT=600  # AI scanner timeout (10 minutes)
# SCAN_CLONE_TIMEOUT=600       # Git clone timeout (10 minutes)
# SCAN_TOTAL_TIMEOUT=3600      # Total scan timeout (1 hour)
#
# LLM Processing Limits
# SCAN_MAX_VULNS_AI=100        # Max vulnerabilities for AI analysis
# SCAN_LLM_BATCH_SIZE=10       # Process vulnerabilities in batches
# SCAN_LLM_REQUEST_TIMEOUT=60  # Timeout per LLM API request
# SCAN_MAX_SNIPPET_CHARS=500   # Truncate code snippets for LLM
# SCAN_MAX_DESC_CHARS=1000     # Truncate descriptions for LLM
#
# ============================================
# GNN MODEL UPDATES (OPTIONAL)
# ============================================
#
# Enable automatic model updates (checks for new versions periodically)
# MODEL_UPDATE_ENABLED=false
#
# URL to check for model updates (must serve a manifest.json)
# Example manifest format:
# {
#   "latest": {
#     "version": "1.0.0",
#     "checksum": "sha256...",
#     "download_url": "https://...",
#     "metrics": {"f1": 0.85}
#   }
# }
# MODEL_UPDATE_URL=https://your-model-server.com/models
#
# How often to check for updates (in hours)
# MODEL_UPDATE_INTERVAL_HOURS=24
#
# Webhook URL for update notifications (optional)
# MODEL_UPDATE_WEBHOOK=https://your-webhook.com/notify
#
# ============================================
